{"version":3,"sources":["../../../src/basic/ToastContainer.js"],"names":["POSITION","ABSOLUTE","BOTTOM","TOP","ToastContainer","config","toastInstance","_root","showToast","getModalState","closeToast","props","state","fadeAnim","Animated","Value","pan","ValueXY","x","y","keyboardHeight","isKeyboardVisible","modalVisible","keyboardDidHide","bind","keyboardDidShow","_panResponder","PanResponder","create","onMoveShouldSetPanResponderCapture","onPanResponderRelease","evt","dx","timing","toValue","duration","start","Keyboard","addListener","position","opacity","width","elevation","paddingHorizontal","Platform","OS","PLATFORM","IOS","top","undefined","bottom","getTop","buttonText","trim","length","setState","e","endCoordinates","height","text","getButtonText","type","supportedOrientations","style","buttonTextStyle","buttonStyle","textStyle","onClose","closeTimeout","clearTimeout","setTimeout","useNativeDriver","reason","closeModal","setValue","panHandlers","getToastStyle","transform","translateX","translateY","Component","propTypes","ViewPropTypes","StyledToastContainer","mapPropsToStyleNames"],"mappings":"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","file":"ToastContainer.js","sourcesContent":["/* eslint-disable class-methods-use-this */\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {\r\n  Keyboard,\r\n  Platform,\r\n  Animated,\r\n  ViewPropTypes,\r\n  PanResponder\r\n} from 'react-native';\r\nimport { connectStyle } from 'native-base-shoutem-theme';\r\n\r\nimport mapPropsToStyleNames from '../utils/mapPropsToStyleNames';\r\nimport { PLATFORM } from '../theme/variables/commonColor';\r\n\r\nimport { Text } from './Text';\r\nimport { Button } from './Button';\r\nimport { Toast } from './Toast';\r\n\r\nconst POSITION = {\r\n  ABSOLUTE: 'absolute',\r\n  BOTTOM: 'bottom',\r\n  TOP: 'top'\r\n};\r\n\r\nclass ToastContainer extends Component {\r\n  static show({ ...config }) {\r\n    this.toastInstance._root.showToast({ config });\r\n  }\r\n  static hide() {\r\n    if (this.toastInstance._root.getModalState()) {\r\n      this.toastInstance._root.closeToast('functionCall');\r\n    }\r\n  }\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      fadeAnim: new Animated.Value(0),\r\n      pan: new Animated.ValueXY({ x: 0, y: 0 }),\r\n      keyboardHeight: 0,\r\n      isKeyboardVisible: false,\r\n      modalVisible: false\r\n    };\r\n\r\n    this.keyboardDidHide = this.keyboardDidHide.bind(this);\r\n    this.keyboardDidShow = this.keyboardDidShow.bind(this);\r\n    this._panResponder = PanResponder.create({\r\n      onMoveShouldSetPanResponderCapture: () => true,\r\n      onPanResponderRelease: (evt, { dx }) => {\r\n        if (dx !== 0) {\r\n          Animated.timing(this.state.pan, {\r\n            toValue: { x: dx, y: 0 },\r\n            duration: 100\r\n          }).start(() => this.closeToast('swipe'));\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  componentDidMount() {\r\n    Keyboard.addListener('keyboardDidShow', this.keyboardDidShow);\r\n    Keyboard.addListener('keyboardDidHide', this.keyboardDidHide);\r\n  }\r\n\r\n  getToastStyle() {\r\n    return {\r\n      position: POSITION.ABSOLUTE,\r\n      opacity: this.state.fadeAnim,\r\n      width: '100%',\r\n      elevation: 9,\r\n      paddingHorizontal: Platform.OS === PLATFORM.IOS ? 20 : 0,\r\n      top: this.state.position === POSITION.TOP ? 30 : undefined,\r\n      bottom:\r\n        this.state.position === POSITION.BOTTOM ? this.getTop() : undefined\r\n    };\r\n  }\r\n\r\n  getTop() {\r\n    if (Platform.OS === PLATFORM.IOS) {\r\n      if (this.state.isKeyboardVisible) {\r\n        return this.state.keyboardHeight;\r\n      }\r\n      return 30;\r\n    }\r\n    return 0;\r\n  }\r\n\r\n  getButtonText(buttonText) {\r\n    if (buttonText) {\r\n      if (buttonText.trim().length === 0) {\r\n        return undefined;\r\n      }\r\n      return buttonText;\r\n    }\r\n    return undefined;\r\n  }\r\n  getModalState() {\r\n    return this.state.modalVisible;\r\n  }\r\n\r\n  static toastInstance;\r\n\r\n  keyboardDidHide() {\r\n    this.setState({\r\n      keyboardHeight: 0,\r\n      isKeyboardVisible: false\r\n    });\r\n  }\r\n\r\n  keyboardDidShow(e) {\r\n    this.setState({\r\n      keyboardHeight: e.endCoordinates.height,\r\n      isKeyboardVisible: true\r\n    });\r\n  }\r\n\r\n  showToast({ config }) {\r\n    this.setState({\r\n      modalVisible: true,\r\n      text: config.text,\r\n      buttonText: this.getButtonText(config.buttonText),\r\n      type: config.type,\r\n      position: config.position ? config.position : POSITION.BOTTOM,\r\n      supportedOrientations: config.supportedOrientations,\r\n      style: config.style,\r\n      buttonTextStyle: config.buttonTextStyle,\r\n      buttonStyle: config.buttonStyle,\r\n      textStyle: config.textStyle,\r\n      onClose: config.onClose\r\n    });\r\n    // If we have a toast already open, cut off its close timeout so that it won't affect *this* toast.\r\n    if (this.closeTimeout) {\r\n      clearTimeout(this.closeTimeout);\r\n    }\r\n    // Set the toast to close after the duration.\r\n    if (config.duration !== 0) {\r\n      const duration = config.duration > 0 ? config.duration : 1500;\r\n      this.closeTimeout = setTimeout(\r\n        this.closeToast.bind(this, 'timeout'),\r\n        duration\r\n      );\r\n    }\r\n    // Fade the toast in now.\r\n    Animated.timing(this.state.fadeAnim, {\r\n      toValue: 1,\r\n      duration: 200,\r\n      useNativeDriver: false\r\n    }).start();\r\n  }\r\n  closeModal(reason) {\r\n    this.setState({\r\n      modalVisible: false\r\n    });\r\n    const { onClose } = this.state;\r\n    if (onClose && typeof onClose === 'function') {\r\n      onClose(reason);\r\n    }\r\n  }\r\n  closeToast(reason) {\r\n    clearTimeout(this.closeTimeout);\r\n    Animated.timing(this.state.fadeAnim, {\r\n      toValue: 0,\r\n      duration: 200,\r\n      useNativeDriver: false\r\n    }).start(() => {\r\n      this.closeModal.bind(this, reason);\r\n      this.state.pan.setValue({ x: 0, y: 0 });\r\n    });\r\n  }\r\n\r\n  render() {\r\n    if (this.state.modalVisible) {\r\n      const { x, y } = this.state.pan;\r\n      return (\r\n        <Animated.View\r\n          {...this._panResponder.panHandlers}\r\n          style={[\r\n            this.getToastStyle(),\r\n            { transform: [{ translateX: x }, { translateY: y }] }\r\n          ]}\r\n        >\r\n          <Toast\r\n            style={[this.state.style]}\r\n            danger={this.state.type === 'danger'}\r\n            success={this.state.type === 'success'}\r\n            warning={this.state.type === 'warning'}\r\n          >\r\n            <Text style={this.state.textStyle}>{this.state.text}</Text>\r\n            {this.state.buttonText && (\r\n              <Button\r\n                style={this.state.buttonStyle}\r\n                onPress={() => this.closeToast('user')}\r\n              >\r\n                <Text style={this.state.buttonTextStyle}>\r\n                  {this.state.buttonText}\r\n                </Text>\r\n              </Button>\r\n            )}\r\n          </Toast>\r\n        </Animated.View>\r\n      );\r\n    }\r\n    return null;\r\n  }\r\n}\r\n\r\nToastContainer.propTypes = {\r\n  ...ViewPropTypes\r\n};\r\n\r\nconst StyledToastContainer = connectStyle(\r\n  'NativeBase.ToastContainer',\r\n  {},\r\n  mapPropsToStyleNames\r\n)(ToastContainer);\r\n\r\nexport { StyledToastContainer as ToastContainer };\r\n"]}